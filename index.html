<!--<script src="https://apis.google.com/js/platform.js" async defer></script>
<script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>-->

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<meta name="google-signin-client_id" content="583488732443-0qrkltufodphbtveim4vv0nhsf5qijog.apps.googleusercontent.com">
<link rel="stylesheet" type="text/css" href="index.css">
<html>
    <head>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script src="https://apis.google.com/js/platform.js" async defer></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
        <!--<script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>-->
        
        <link href="https://fonts.googleapis.com/css?family=Alegreya|Courgette|Lobster+Two" rel="stylesheet">
        <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>
        <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase-database.js"></script>
    </head>
    <body>
        <!--<div class="g-signin2" data-onsuccess="onSignIn"></div>-->
        
        <form>
            <div class = "form-group">
              <div id="whiteText">email:</div>
              <input type="text" name="email" id="email">
              <div id="whiteText">password:</div>
              <input type="password" name="password" id="password">
            </div>
          <button class="btn btn-primary" onclick="myFunction()">Sign Up4</button>
        </form>

    </body>
    <script>
      // Initialize Firebase
       var config = {
        apiKey: "AIzaSyB7quSFbdzOHH_S4B1TOntym_xTj4Yx6To",
        authDomain: "chrome-calendar.firebaseapp.com",
        databaseURL: "https://chrome-calendar.firebaseio.com",
        storageBucket: "chrome-calendar.appspot.com",
        messagingSenderId: "583488732443"
      };
      firebase.initializeApp(config);
        $(document).keypress(function(event){
            if(event.keyCode == 13){
                //alert("enter pressed");
                $("#submit").trigger('click');
            }
        });
        function myFunction(){
            var email = $('#email').val();
            var password = $('#password').val();
            console.log("xox");
            //alert(email);
            console.log(password);
            firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {
              // Handle Errors here.
              var errorCode = error.code;
              var errorMessage = error.message;
              //alert(error.message);
              // ...
            });
            var postData = {
                email: email,
                animal: "wolf"
            };
            var newKey = firebase.database().ref().child('users').push().key;
            console.log(newKey);
            sessionStorage.setItem('UID', newKey);
            //alert(newKey);
            var updates = {};
          updates['/users/' + newKey] = postData;
          //return firebase.database().ref().update(updates);
          //window.location.replace("table.html");    
            firebase.database().ref().update(updates);
            //alert("let's try");
            //window.location.replace("https://chromecalendar.github.io/table.html");    
             /*firebase.database().ref('/users/' + newKey).set({
               
              });*/
            /*
              firebase.database().ref('users/' + newKey).set({
                email: email,
                animal: dog
              });*/
            
            
        }
        firebase.auth().onAuthStateChanged(function(user) {
          alert("auth state changed");
          if (user) {
            // User is signed in.
              alert("we are going");
              window.location.href="table.html";
          } else {
            // No user is signed in.
          }
        });
        /*var userRef = firebase.database().ref('/users');
        userRef.on('child_added', function(snapshot) {
          //userRef(postElement, snapshot.val());
            var newUser = snapshot.val();
            alert(newUser.keyCode);
        });*/
        firebase.database().ref('/users').once('value').then(function(snapshot) {
          var username = snapshot.val();
          //alert(username);
          // ...
        });
        
      /*function myFunction(){
          var usersRef = new Firebase('https://chrome-calendar.firebaseio.com');
          usersRef.createUser({
            email: "bobtony@firebase.com",
            password: "correcthorsebatterystaple"
            }, function(error, userData) {
          if (error) {
            switch (error.code) {
              case "EMAIL_TAKEN":
                console.log("The new user account cannot be created because the email is already in use.");
                break;
              case "INVALID_EMAIL":
                console.log("The specified email is not a valid email.");
                break;
              default:
                console.log("Error creating user:", error);
            }
          } else {
            console.log("Successfully created user account with uid:", userData.uid);
          }
        });
      }*/
    </script>
</html>
